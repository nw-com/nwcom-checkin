<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>測試頁面管理器</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
    </style>
</head>
<body>
    <h1>頁面管理器測試</h1>
    <div id="testResults"></div>
    
    <script>
        function addResult(message, type = 'success') {
            const resultsDiv = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            resultsDiv.appendChild(resultDiv);
        }
        
        // 測試頁面管理器
        function testPageManager() {
            console.log('開始測試頁面管理器...');
            
            // 測試 1: 檢查 window.pageManager 是否存在
            if (window.pageManager) {
                addResult('✅ window.pageManager 存在');
                
                // 測試 2: 檢查主要方法
                const methods = ['loadPage', 'toggleSidebar', 'checkPagePermission'];
                methods.forEach(method => {
                    if (typeof window.pageManager[method] === 'function') {
                        addResult(`✅ ${method} 方法存在`);
                    } else {
                        addResult(`❌ ${method} 方法不存在`, 'error');
                    }
                });
                
                // 測試 3: 檢查頁面列表
                if (window.pageManager.pages) {
                    addResult(`✅ 頁面列表載入完成，共 ${Object.keys(window.pageManager.pages).length} 個頁面`);
                } else {
                    addResult('❌ 頁面列表未載入', 'error');
                }
                
                // 測試 4: 嘗試載入儀表板頁面
                try {
                    const contentArea = document.createElement('div');
                    contentArea.id = 'content-area';
                    document.body.appendChild(contentArea);
                    
                    window.pageManager.loadPage('dashboard').then(() => {
                        addResult('✅ 儀表板頁面載入成功');
                    }).catch(error => {
                        addResult(`❌ 儀表板頁面載入失敗: ${error.message}`, 'error');
                    });
                } catch (error) {
                    addResult(`❌ 頁面載入測試失敗: ${error.message}`, 'error');
                }
                
            } else {
                addResult('❌ window.pageManager 不存在', 'error');
                addResult('頁面管理器未正確初始化，這就是按鈕無反應的原因！', 'warning');
            }
        }
        
        // 頁面載入完成後執行測試
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', testPageManager);
        } else {
            testPageManager();
        }
    </script>
    
    <!-- 載入必要的腳本 -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/pages.js"></script>
</body>
</html>