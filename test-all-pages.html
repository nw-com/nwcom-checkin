<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>測試所有頁面載入</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-container { display: flex; gap: 20px; }
        .page-list { flex: 1; }
        .page-content { flex: 2; border: 1px solid #ccc; padding: 20px; min-height: 400px; }
        .page-button { display: block; width: 100%; margin: 5px 0; padding: 10px; border: 1px solid #ddd; background: #f9f9f9; cursor: pointer; }
        .page-button:hover { background: #e9e9e9; }
        .page-button.success { background: #d4edda; border-color: #c3e6cb; }
        .page-button.error { background: #f8d7da; border-color: #f5c6cb; }
        .loading { text-align: center; padding: 50px; }
        .error { color: red; padding: 20px; }
        .success { color: green; padding: 20px; }
    </style>
</head>
<body>
    <h1>測試所有頁面載入</h1>
    <p>點擊左側的頁面按鈕來測試載入情況：</p>
    
    <div class="test-container">
        <div class="page-list">
            <h3>可用頁面</h3>
            <button class="page-button" onclick="testPage('dashboard')">儀表板</button>
            <button class="page-button" onclick="testPage('community')">社區管理</button>
            <button class="page-button" onclick="testPage('personnel')">人員管理</button>
            <button class="page-button" onclick="testPage('checkin')">打卡管理</button>
            <button class="page-button" onclick="testPage('reports')">報表中心</button>
            <button class="page-button" onclick="testPage('system')">系統管理</button>
            <button class="page-button" onclick="testPage('account')">帳號管理</button>
        </div>
        
        <div class="page-content" id="pageContent">
            <div class="loading">請選擇一個頁面進行測試</div>
        </div>
    </div>
    
    <div style="margin-top: 20px;">
        <h3>測試結果總結</h3>
        <div id="testSummary"></div>
    </div>

    <script src="js/firebase-config.js"></script>
    <script src="js/pages.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        const testResults = {};
        
        async function testPage(pageName) {
            const contentDiv = document.getElementById('pageContent');
            const button = event.target;
            
            // 顯示載入中
            contentDiv.innerHTML = '<div class="loading">載入中...</div>';
            button.className = 'page-button';
            
            try {
                console.log(`正在測試頁面: ${pageName}`);
                
                // 使用頁面管理器載入頁面
                await pageManager.loadPage(pageName);
                
                // 檢查載入的內容
                const pageContent = contentDiv.innerHTML;
                
                if (pageContent.includes('頁面不存在')) {
                    throw new Error('頁面顯示「不存在」訊息');
                } else if (pageContent.includes('載入失敗')) {
                    throw new Error('頁面顯示「載入失敗」訊息');
                } else if (pageContent.trim() === '' || pageContent.includes('載入中')) {
                    throw new Error('頁面內容為空或停留在載入狀態');
                } else {
                    // 成功
                    button.className = 'page-button success';
                    testResults[pageName] = '成功';
                    console.log(`✓ ${pageName} 頁面載入成功`);
                }
                
            } catch (error) {
                // 失敗
                button.className = 'page-button error';
                contentDiv.innerHTML = `<div class="error">錯誤: ${error.message}</div>`;
                testResults[pageName] = `失敗: ${error.message}`;
                console.error(`✗ ${pageName} 頁面載入失敗:`, error);
            }
            
            updateTestSummary();
        }
        
        function updateTestSummary() {
            const summaryDiv = document.getElementById('testSummary');
            let html = '<table style="width: 100%; border-collapse: collapse;">';
            html += '<tr style="background: #f5f5f5;"><th style="padding: 10px; border: 1px solid #ddd;">頁面</th><th style="padding: 10px; border: 1px solid #ddd;">狀態</th></tr>';
            
            for (const [page, result] of Object.entries(testResults)) {
                const color = result.includes('成功') ? 'green' : 'red';
                html += `<tr><td style="padding: 10px; border: 1px solid #ddd;">${page}</td><td style="padding: 10px; border: 1px solid #ddd; color: ${color};">${result}</td></tr>`;
            }
            
            html += '</table>';
            summaryDiv.innerHTML = html;
        }
        
        // 頁面載入完成後顯示狀態
        window.addEventListener('DOMContentLoaded', function() {
            console.log('測試頁面已載入完成');
            console.log('頁面管理器狀態:', typeof pageManager !== 'undefined' ? '已初始化' : '未初始化');
            
            if (typeof pageManager !== 'undefined') {
                console.log('可用頁面:', Object.keys(pageManager.pages));
            }
        });
    </script>
</body>
</html>